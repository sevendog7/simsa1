<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>적극행정 우수사례 2차 심사표 집계</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
            color: #333;
        }
        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type="number"] {
            -moz-appearance: textfield;
        }
        /* 읽기 전용 입력란 스타일 */
        input[readonly] {
            background-color: #f3f4f6;
            border: none;
            cursor: default;
            font-weight: 500;
            padding-left: 0.5rem;
        }
        .score-input {
            min-width: 4rem; /* 모바일에서 최소 너비 보장 */
        }
        @media print {
            body { background-color: #fff; margin: 0; padding: 0; }
            .max-w-7xl { max-width: none; box-shadow: none; padding: 0; }
            .no-print { display: none; }
            table { font-size: 8pt; table-layout: fixed; }
            th, td { padding: 2px 1px; }
            h1, h2 { font-size: 1rem; }
        }
    </style>
</head>
<body class="bg-gray-100 p-4 sm:p-8">
    <div class="max-w-7xl mx-auto bg-white shadow-xl rounded-2xl p-6 sm:p-8">
        <h1 class="text-2xl sm:text-3xl font-bold text-center text-blue-800 mb-6">적극행정 우수사례 2차 심사표 (개인별)</h1>

        <!-- [변경] 반응형 버튼 컨테이너 -->
        <div class="no-print mb-6 flex flex-col sm:flex-row sm:justify-between items-center gap-4">
            <div class="flex space-x-4">
                <button id="complete-button" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300">
                    입력완료 (저장)
                </button>
                <button id="reset-button" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300">
                    점수 초기화
                </button>
            </div>
            <div>
                <button id="print-button" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300">
                    출력 (MS Word)
                </button>
            </div>
        </div>

        <div class="overflow-x-auto rounded-xl mb-8 border">
            <table class="w-full text-sm text-left text-gray-700">
                <thead class="text-xs text-white uppercase bg-blue-600">
                    <tr>
                        <th scope="col" class="p-3 text-center">연번</th>
                        <th scope="col" class="p-3 text-center min-w-[200px]">사례명</th>
                        <th scope="col" class="p-3 text-center min-w-[100px]">국민<br>체감도 (20)</th>
                        <th scope="col" class="p-3 text-center min-w-[100px]">적극성<br>및 창의성 (30)</th>
                        <th scope="col" class="p-3 text-center min-w-[100px]">중요도 및<br>난이도 (30)</th>
                        <th scope="col" class="p-3 text-center min-w-[100px]">확산<br>가능성 (10)</th>
                        <th scope="col" class="p-3 text-center min-w-[100px]">국민<br>호응도 (10)</th>
                        <th scope="col" class="p-3 text-center min-w-[100px] font-bold">합계 (100)</th>
                    </tr>
                </thead>
                <tbody id="score-table-body" class="bg-white divide-y divide-gray-200">
                </tbody>
            </table>
        </div>

        <div class="flex flex-col sm:flex-row justify-end items-start sm:items-center space-y-4 sm:space-y-0 sm:space-x-8 mt-8">
            <div class="flex items-center space-x-2 w-full sm:w-auto">
                <label for="judge-name" class="text-gray-700 font-semibold whitespace-nowrap">작성자(심사위원):</label>
                <div class="flex items-center p-2 border-b border-gray-300 w-full">
                    <input type="text" id="judge-name" class="p-1 w-full focus:outline-none bg-white">
                    <span class="ml-2 font-bold">(인)</span>
                </div>
            </div>
            <div class="flex items-center space-x-2 w-full sm:w-auto">
                <label for="chair-name" class="text-gray-700 font-semibold whitespace-nowrap">확인자(위원장):</label>
                <div class="flex items-center p-2 border-b border-gray-300 w-full">
                    <input type="text" id="chair-name" class="p-1 w-full focus:outline-none bg-white">
                    <span class="ml-2 font-bold">(인)</span>
                </div>
            </div>
        </div>

        <div class="mt-12 rounded-xl">
            <h2 class="text-xl sm:text-2xl font-bold text-center text-blue-700 mb-4">심사내용 배점기준표</h2>
            <div class="overflow-x-auto border rounded-xl">
                <table class="w-full text-sm text-center text-gray-700">
                    <thead class="text-xs text-white uppercase bg-gray-500">
                        <tr><th scope="col" class="p-3 border-r">심사항목</th><th scope="col" class="p-3 border-r min-w-[300px]">심사내용</th><th scope="col" class="p-3 border-r">배점</th><th scope="col" class="p-3">매우 우수</th><th scope="col" class="p-3">우수</th><th scope="col" class="p-3">보통</th><th scope="col" class="p-3">미흡</th><th scope="col" class="p-3">매우 미흡</th></tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        <tr class="hover:bg-gray-50"><td class="p-3 border-r font-semibold">국민체감도</td><td class="p-3 border-r text-left"><ul class="list-disc list-inside"><li>국민 생활편의 및 만족도를 제고하거나 국가재정 절감에 기여하는 등 국민이 체감할 수 있는 변화 정도를 평가</li></ul></td><td class="p-3 border-r">20</td><td class="p-3">20-18</td><td class="p-3">17-14</td><td class="p-3">13~10</td><td class="p-3">9~6</td><td class="p-3">5~</td></tr>
                        <tr class="hover:bg-gray-50"><td class="p-3 border-r font-semibold">적극성<br>창의성<br>전문성</td><td class="p-3 border-r text-left"><ul class="list-disc list-inside space-y-1"><li>새로운 정책 발굴, 이해 조정 및 협업 등 문제해결을 위해 적극적으로 노력한 정도를 평가</li><li>해당 과제를 새로운 관점에서 효과적으로 해결하거나 전문지식 경험 등을 활용한 정도를 평가</li></ul></td><td class="p-3 border-r">30</td><td class="p-3">30-25</td><td class="p-3">24-19</td><td class="p-3">18-13</td><td class="p-3">12-7</td><td class="p-3">6-</td></tr>
                        <tr class="hover:bg-gray-50"><td class="p-3 border-r font-semibold">중요도 및<br>난이도</td><td class="p-3 border-r text-left"><ul class="list-disc list-inside space-y-1"><li>국가 전반의 경쟁력을 제고하는데 도움이 되는 정도</li><li>관련 업무나 민원요구를 해결하기 어려운 정도 또는 열악한 정책 환경 등을 평가</li></ul></td><td class="p-3 border-r">30</td><td class="p-3">30-25</td><td class="p-3">24-19</td><td class="p-3">18-13</td><td class="p-3">12-7</td><td class="p-3">6-</td></tr>
                        <tr class="hover:bg-gray-50"><td class="p-3 border-r font-semibold">확산 가능성</td><td class="p-3 border-r text-left"><ul class="list-disc list-inside"><li>동 사례에서 나타난 적극행정 노력이 타 기관으로 확산될 가능성이 있는지를 평가</li></ul></td><td class="p-3 border-r">10</td><td class="p-3">10-9</td><td class="p-3">8-7</td><td class="p-3">6-5</td><td class="p-3">4-3</td><td class="p-3">2-</td></tr>
                    </tbody>
                </table>
            </div>
            <div class="overflow-x-auto border rounded-xl mt-8">
                <table class="w-full text-sm text-center text-gray-700">
                    <thead class="text-xs text-white uppercase bg-gray-500">
                        <tr><th scope="col" class="p-3 border-r">심사항목</th><th scope="col" class="p-3 border-r min-w-[300px]">심사내용</th><th scope="col" class="p-3 border-r">배점</th><th scope="col" class="p-3">1위</th><th scope="col" class="p-3">2위</th><th scope="col" class="p-3">3위</th><th scope="col" class="p-3">4위</th><th scope="col" class="p-3">5위</th><th scope="col" class="p-3">6위 이하</th></tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        <tr class="hover:bg-gray-50"><td class="p-3 border-r font-semibold">국민호응도</td><td class="p-3 border-r text-left"><ul class="list-disc list-inside"><li>온라인 국민투표 결과(1위~6위 이하 순위별 배점)</li></ul></td><td class="p-3 border-r">10</td><td class="p-3">10</td><td class="p-3">9</td><td class="p-3">8</td><td class="p-3">7</td><td class="p-3">6</td><td class="p-3">5</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // ★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★
            //            여기에 심사할 사례명을 순서대로 10개 입력하세요.
            // ★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★
            const caseNames = [
                "디지털 기반(AI·빅데이터)의 산불 확산 예측시스템 구축",
                "국민 비서 ‘구삐’를 통한 선제적 고지·안내 서비스",
                "공공 웹사이트 ‘로그인’의 민간인증서 적용",
                "긴급차량 우선신호 시스템 전국 확산",
                "어려운 행정용어를 쉽고 바르게 개선",
                "6번째 사례명을 여기에 입력하세요",
                "7번째 사례명을 여기에 입력하세요",
                "8번째 사례명을 여기에 입력하세요",
                "9번째 사례명을 여기에 입력하세요",
                "10번째 사례명을 여기에 입력하세요"
            ];

            const tableBody = document.getElementById('score-table-body');
            const numRows = 10;
            const storageKey = 'activeAdminEvaluationData_3';

            // 1. 테이블 행 동적 생성
            for (let i = 1; i <= numRows; i++) {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50 transition-colors duration-200';
                row.innerHTML = `
                    <td class="p-3 text-center text-gray-900 font-medium">${i}</td>
                    <td class="p-3"><input type="text" value="${caseNames[i-1] || ''}" class="w-full text-sm" readonly></td>
                    <td class="p-3 text-center"><input type="number" data-score-for="case-${i}" data-max="20" class="score-input w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-blue-400 text-center transition duration-300 text-sm"></td>
                    <td class="p-3 text-center"><input type="number" data-score-for="case-${i}" data-max="30" class="score-input w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-blue-400 text-center transition duration-300 text-sm"></td>
                    <td class="p-3 text-center"><input type="number" data-score-for="case-${i}" data-max="30" class="score-input w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-blue-400 text-center transition duration-300 text-sm"></td>
                    <td class="p-3 text-center"><input type="number" data-score-for="case-${i}" data-max="10" class="score-input w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-blue-400 text-center transition duration-300 text-sm"></td>
                    <td class="p-3 text-center"><input type="number" data-score-for="case-${i}" data-max="10" class="score-input w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-blue-400 text-center transition duration-300 text-sm"></td>
                    <td class="p-3 text-center font-bold text-lg text-blue-700" id="total-case-${i}">0</td>
                `;
                tableBody.appendChild(row);
            }
            
            const scoreInputs = document.querySelectorAll('.score-input');

            // 2. 합계 계산 함수
            function calculateTotal(caseId) {
                const scoreInputs = document.querySelectorAll(`[data-score-for="${caseId}"]`);
                let total = 0;
                scoreInputs.forEach(input => {
                    input.value = input.value.split('.')[0];
                    const value = parseInt(input.value) || 0;
                    const max = parseInt(input.dataset.max);
                    if (value > max) { input.value = max; }
                    else if (value < 0) { input.value = 0; }
                    total += parseInt(input.value) || 0;
                });
                document.getElementById(`total-${caseId}`).innerText = total;
            }

            // 3. 점수 입력칸 이벤트 리스너
            scoreInputs.forEach(input => {
                input.addEventListener('input', (event) => {
                    calculateTotal(event.target.dataset.scoreFor);
                });
            });

            // 4. 데이터 저장 함수
            function saveData() {
                const dataToSave = {
                    judgeName: document.getElementById('judge-name').value,
                    chairName: document.getElementById('chair-name').value,
                    scores: []
                };
                for (let i = 1; i <= numRows; i++) {
                    const scores = Array.from(document.querySelectorAll(`[data-score-for="case-${i}"]`)).map(input => input.value);
                    dataToSave.scores.push(scores);
                }
                localStorage.setItem(storageKey, JSON.stringify(dataToSave));
                alert('입력 내용이 성공적으로 저장되었습니다.');
            }

            // 5. 데이터 불러오기 함수
            function loadData() {
                const savedData = localStorage.getItem(storageKey);
                if (savedData) {
                    const data = JSON.parse(savedData);
                    document.getElementById('judge-name').value = data.judgeName || '';
                    document.getElementById('chair-name').value = data.chairName || '';
                    
                    data.scores.forEach((scores, index) => {
                        const i = index + 1;
                        const scoreInputsForRow = document.querySelectorAll(`[data-score-for="case-${i}"]`);
                        scoreInputsForRow.forEach((input, scoreIndex) => {
                            input.value = scores[scoreIndex] || '';
                        });
                        calculateTotal(`case-${i}`);
                    });
                }
            }
            
            // 6. 점수 초기화 함수
            function resetScores() {
                if (confirm('정말로 모든 점수와 입력 내용을 초기화하시겠습니까?')) {
                    scoreInputs.forEach(input => { input.value = ''; });
                    document.querySelectorAll('[id^="total-case-"]').forEach(totalCell => { totalCell.innerText = '0'; });
                    document.getElementById('judge-name').value = '';
                    document.getElementById('chair-name').value = '';
                    localStorage.removeItem(storageKey);
                    alert('모든 내용이 초기화되었습니다.');
                }
            }
            
            // 7. 버튼 이벤트 리스너 연결
            document.getElementById('complete-button').addEventListener('click', saveData);
            document.getElementById('reset-button').addEventListener('click', resetScores);
            document.getElementById('print-button').addEventListener('click', () => {
                const judgeName = document.getElementById('judge-name').value;
                const chairName = document.getElementById('chair-name').value;
                let tableHtml = '';
                document.querySelectorAll('#score-table-body tr').forEach((row, index) => {
                    const caseNumber = index + 1;
                    const caseName = caseNames[index] || '';
                    const scores = Array.from(row.querySelectorAll('.score-input')).map(input => input.value || '0');
                    const totalScore = row.querySelector('.text-lg').innerText;

                    if (parseInt(totalScore) > 0) {
                        tableHtml += `<tr><td>${caseNumber}</td><td style="text-align:left; padding-left:5px;">${caseName}</td><td style="font-size:12pt;">${scores[0]}</td><td style="font-size:12pt;">${scores[1]}</td><td style="font-size:12pt;">${scores[2]}</td><td style="font-size:12pt;">${scores[3]}</td><td style="font-size:12pt;">${scores[4]}</td><td style="font-size:12pt; font-weight:bold;">${totalScore}</td></tr>`;
                    }
                });

                const htmlContent = `<!DOCTYPE html><html lang="ko"><head><meta charset="UTF-8"><title>적극행정 우수사례 2차 심사표 집계</title><style>body{font-family:'Hancom Santteut Dotum','한컴산뜻돋움',sans-serif;font-size:8pt;margin:2cm 0.8cm 1.5cm 0.8cm;padding:0;box-sizing:border-box;text-align:center;}h1,h2{margin:0;padding:0;text-align:center;}table{width:100%;border-collapse:collapse;margin-bottom:10px;page-break-inside:avoid;}th,td{border:1px solid #000;padding:3px;text-align:center;vertical-align:middle;word-break:break-all;}th{background-color:#f2f2f2;}.main-table th{background-color:#d1e2f7;}</style></head><body><h1 style="font-size:14pt;font-weight:bold;margin-bottom:10px;">적극행정 우수사례 2차 심사표 (개인별)</h1><table class="main-table"><thead><tr><th style="width:5%;">연번</th><th style="width:30%;">사례명</th><th style="width:10%;">국민 체감도 (20)</th><th style="width:10%;">적극성<br>및 창의성 (30)</th><th style="width:10%;">중요도 및<br>난이도 (30)</th><th style="width:10%;">확산 가능성 (10)</th><th style="width:10%;">국민 호응도 (10)</th><th style="width:15%;">합계 (100)</th></tr></thead><tbody>${tableHtml}</tbody></table><div style="text-align:right;margin-top:20px;font-size:12pt;"><span>작성자(심사위원): ${judgeName} (인)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>확인자(위원장): ${chairName} (인)</span></div></body></html>`;

                const blob = new Blob([htmlContent], { type: 'application/msword' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = '적극행정_심사표3.doc';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            });

            // 페이지 로드 시 저장된 데이터 불러오기
            loadData();
        });
    </script>
</body>
</html>
